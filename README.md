# Torrent-Tracker

Трекер хранит только то, что такой-то файл можно скачать у соответствующих пиров

Завести 2 потока
1. в одном читаются ip-адреса подключающихся пиров, 
2. во втором мониторятся подключенные пиры

# База 
Есть [база](https://github.com/Aksinya-Bykova/Torrent-Tracker/blob/main/data/File-Peers.db) вида

> ключ = [название файла]
>
> значение = [список пиров, имеющих сегменты данного файла]

Список пиров – это список ip-адресов. Здесь смоделируем на одном компьютере, для простоты список пиров будет списком локальных портов

**NB!** Для использования необходимо установить фреймворк [pickledb](https://github.com/patx/pickledb)
```
pip install pickledb
```

# Мониторинг
[Мониторинг](https://github.com/Aksinya-Bykova/Torrent-Tracker/blob/main/monitoring.py) подключенных пиров производится раз в const = 10 секунд времени. См. watchdog

Трекер проходит по списку ключей, берёт по ключу список пиров, каждый пир прозванивает и спрашивает “есть ли у тебя данный файл?” (из ключа). В случае изменений обновляет значения в базе.

Появление нового файла у пира отслеживается так. Пир сам сообщает трекеру, что он загрузил новый файл, [трекер соответствующе вносит изменения в базу](https://github.com/Aksinya-Bykova/Torrent-Tracker/blob/main/update_list.py)

# Протокол общения с клиентом
Уведомление трекера о добавлении файла в пире
```
SET_FILE
file_name
```

Запрос трекера на наличие файла у пира
```
EXIST_FILE
file_name
```

Ответ пира на наличие файла
```
EXIST_FILE
file_name
TRUE/FALSE
```

Запрос пира о списке пиров с данным файлом
```
GET_PEERS
file_name
```

Ответ трекера со списком файлов
```
GET_PEERS
file_name
peer1
peer2
...
```

# Version
Python 3.8
